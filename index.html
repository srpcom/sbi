<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jadwal CSR Ramadhan 1447 H</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- tsParticles -->
    <script src="https://cdn.jsdelivr.net/npm/tsparticles@2.11.1/tsparticles.bundle.min.js"></script>
    
    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: #f0fdf4; /* Emerald-50 base */
            
            /* ISLAMIC GEOMETRIC PATTERN (ARABESQUE) */
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23059669' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3Cpath d='M36 34c0-2.21-1.79-4-4-4s-4 1.79-4 4 1.79 4 4 4 4-1.79 4-4zM6 34c0-2.21-1.79-4-4-4S-2 31.79-2 34s1.79 4 4 4 4-1.79 4-4zM6 4C6 1.79 4.21 0 2 0S-2 1.79-2 4s1.79 4 4 4 4-1.79 4-4zM36 4c0-2.21-1.79-4-4-4s-4 1.79-4 4 1.79 4 4 4 4-1.79 4-4z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            background-attachment: fixed;
        }
        
        #tsparticles canvas {
            position: absolute !important;
            top: 0;
            left: 0;
            width: 100% !important;
            height: 100% !important;
            z-index: 0;
        }

        @keyframes ring-pulse {
            0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); }
            100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
        }

        @keyframes bounce-slow {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        @keyframes slide-up {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* Glassmorphism Card Style */
        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
        }

        .card-today {
            animation: ring-pulse 2s infinite;
            border-color: #10b981 !important;
            background: linear-gradient(to bottom right, rgba(255, 255, 255, 0.95), rgba(240, 253, 244, 0.95));
            z-index: 10;
        }
        
        .badge-today {
            animation: bounce-slow 2s infinite;
        }

        .fab-slide-up {
            animation: slide-up 0.3s ease-out forwards;
        }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ICONS COMPONENTS ---
        const Icon = ({ children, size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {children}
            </svg>
        );

        const CalendarIcon = (props) => <Icon {...props}><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></Icon>;
        const MapPin = (props) => <Icon {...props}><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></Icon>;
        const ShoppingBag = (props) => <Icon {...props}><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path><line x1="3" y1="6" x2="21" y2="6"></line><path d="M16 10a4 4 0 0 1-8 0"></path></Icon>;
        const Gift = (props) => <Icon {...props}><polyline points="20 12 20 22 4 22 4 12"></polyline><rect x="2" y="7" width="20" height="5"></rect><line x1="12" y1="22" x2="12" y2="7"></line><path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"></path><path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"></path></Icon>;
        const BookOpen = (props) => <Icon {...props}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></Icon>;
        const Utensils = (props) => <Icon {...props}><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"></path><path d="M7 2v20"></path><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"></path></Icon>;
        const Moon = (props) => <Icon {...props}><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></Icon>;
        const ShareIcon = (props) => <Icon {...props}><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></Icon>;
        const CheckSquare = (props) => <Icon {...props}><polyline points="9 11 12 14 22 4"></polyline><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path></Icon>;
        const Search = (props) => <Icon {...props}><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></Icon>;
        const Clock = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></Icon>;
        const CalendarPlus = (props) => <Icon {...props}><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line><line x1="10" y1="16" x2="14" y2="16"></line><line x1="12" y1="14" x2="12" y2="18"></line></Icon>;

        // --- DATA ---
        // Assumption: Year 2026 based on previous context or generalized for 1447H
        const YEAR = 2026;
        const scheduleData = [
            { id: 1, day: 19, month: 1, date: "Kamis, 19", ramadhan: 1, event: "Awal Ramadhan", loc: "", category: "Lainnya" },
            { id: 2, day: 20, month: 1, date: "Jum'at, 20", ramadhan: 2, event: "", loc: "", category: "Lainnya" },
            { id: 3, day: 21, month: 1, date: "Sabtu, 21", ramadhan: 3, event: "", loc: "", category: "Lainnya" },
            { id: 4, day: 22, month: 1, date: "Minggu, 22", ramadhan: 4, event: "", loc: "", category: "Lainnya" },
            { id: 5, day: 23, month: 1, date: "Senin, 23", ramadhan: 5, event: "Kampung Bazar Ramadhan", loc: "Desa Merkawang", category: "Bazar" },
            { id: 6, day: 24, month: 1, date: "Selasa, 24", ramadhan: 6, event: "Bukber dengan PKM, Kop PKM dan Tim 6", loc: "Langgeng Resto", category: "Bukber" },
            { id: 7, day: 25, month: 1, date: "Rabu, 25", ramadhan: 7, event: "Kampung Bazar Ramadhan", loc: "Desa Karangasem", category: "Bazar" },
            { id: 8, day: 26, month: 1, date: "Kamis, 26", ramadhan: 8, event: "Bukber dgn OPD dan Stakeholder", loc: "Lynn Hotel", category: "Bukber" },
            { id: 9, day: 27, month: 1, date: "Jum'at, 27", ramadhan: 9, event: "Kampung Bazar Ramadhan", loc: "Desa Glondonggede", category: "Bazar" },
            { id: 10, day: 28, month: 1, date: "Sabtu, 28", ramadhan: 10, event: "", loc: "", category: "Lainnya" },
            { id: 11, day: 1, month: 2, date: "Minggu, 1", ramadhan: 11, event: "", loc: "", category: "Lainnya" },
            { id: 12, day: 2, month: 2, date: "Senin, 2", ramadhan: 12, event: "Lomba Semarak Ramadhan Tahfidz Al-Qur'an (RKTM)", loc: "", category: "Edukasi" },
            { id: 13, day: 3, month: 2, date: "Selasa, 3", ramadhan: 13, event: "Kampung Bazar Ramadhan", loc: "Desa Sawir", category: "Bazar" },
            { id: 14, day: 4, month: 2, date: "Rabu, 4", ramadhan: 14, event: "Kampung Bazar Ramadhan", loc: "Desa Mliwang", category: "Bazar" },
            { id: 15, day: 5, month: 2, date: "Kamis, 5", ramadhan: 15, event: "Pelatihan Manajemen Masjid & Dakwah Digital serta Buka Bersama Ustadz", loc: "Masjid SBI Pabrik Tuban", category: "Edukasi" },
            { id: 16, day: 6, month: 2, date: "Jum'at, 6", ramadhan: 16, event: "900 Paket Sembako di 8 Desa", loc: "Socorejo, Sobontoro, Kenanti, Tambakboyo, Pabeyan, Gadon, Klutuk", category: "Sosial" },
            { id: 17, day: 7, month: 2, date: "Sabtu, 7", ramadhan: 17, event: "Bukber GAC Family", loc: "Surabaya", category: "Bukber" },
            { id: 18, day: 8, month: 2, date: "Minggu, 8", ramadhan: 18, event: "", loc: "", category: "Lainnya" },
            { id: 19, day: 9, month: 2, date: "Senin, 9", ramadhan: 19, event: "1.400 Paket Sembako di 4 Desa & Kampung Bazar", loc: "Sawir, Karangasem, Glondonggede, Merkawang, Kedungrejo", category: "Sosial" },
            { id: 20, day: 10, month: 2, date: "Selasa, 10", ramadhan: 20, event: "1.000 Paket Sembako di 4 Desa", loc: "Mliwang (350), Kedungrejo (350), Gaji (200), Wolutengah (100)", category: "Sosial" },
            { id: 21, day: 11, month: 2, date: "Rabu, 11", ramadhan: 21, event: "Bukber Kepala Desa & Camat Family + Pembagian 350 Paket Karyawan", loc: "Lynn Hotel Resto", category: "Bukber" },
            { id: 22, day: 12, month: 2, date: "Kamis, 12", ramadhan: 22, event: "Bukber GAC dan Driver", loc: "Javanilla Resto", category: "Bukber" },
            { id: 23, day: 13, month: 2, date: "Jum'at, 13", ramadhan: 23, event: "", loc: "", category: "Lainnya" },
            { id: 24, day: 14, month: 2, date: "Sabtu, 14", ramadhan: 24, event: "", loc: "", category: "Lainnya" }
        ];

        const categories = [
            { id: 'Semua', label: 'Semua Agenda', icon: CalendarIcon, color: 'bg-emerald-800' },
            { id: 'Bazar', label: 'Bazar', icon: ShoppingBag, color: 'bg-rose-500' },
            { id: 'Bukber', label: 'Bukber', icon: Utensils, color: 'bg-amber-500' },
            { id: 'Sosial', label: 'Sosial', icon: Gift, color: 'bg-cyan-500' },
            { id: 'Edukasi', label: 'Edukasi', icon: BookOpen, color: 'bg-indigo-500' }
        ];

        // --- COMPONENTS ---
        
        const Countdown = ({ events }) => {
            const [timeLeft, setTimeLeft] = useState(null);
            const [nextEvent, setNextEvent] = useState(null);

            useEffect(() => {
                const calculateTimeLeft = () => {
                    const now = new Date();
                    // Find next event
                    const upcoming = events
                        .filter(e => e.event) // Only items with actual events
                        .map(e => {
                            // Construct valid date object
                            const d = new Date(YEAR, e.month, e.day, 16, 0, 0); // Assume 16:00 (4 PM) event start
                            return { ...e, fullDate: d };
                        })
                        .filter(e => e.fullDate > now)
                        .sort((a, b) => a.fullDate - b.fullDate)[0];

                    setNextEvent(upcoming);

                    if (upcoming) {
                        const difference = upcoming.fullDate - now;
                        let days = Math.floor(difference / (1000 * 60 * 60 * 24));
                        let hours = Math.floor((difference / (1000 * 60 * 60)) % 24);
                        let minutes = Math.floor((difference / 1000 / 60) % 60);
                        setTimeLeft({ days, hours, minutes });
                    }
                };

                calculateTimeLeft();
                const timer = setInterval(calculateTimeLeft, 60000); // Update every minute
                return () => clearInterval(timer);
            }, [events]);

            if (!nextEvent || !timeLeft) return (
                <div className="bg-emerald-800/50 backdrop-blur-sm p-4 rounded-xl border border-emerald-700/50 text-emerald-100 max-w-sm mx-auto mt-6">
                    <p className="text-sm">Semua agenda telah selesai.</p>
                </div>
            );

            return (
                <div className="bg-white/10 backdrop-blur-md p-4 rounded-xl border border-white/20 text-white max-w-md mx-auto mt-6 shadow-xl">
                    <div className="flex items-center justify-center gap-2 mb-2 text-emerald-200 text-xs font-bold uppercase tracking-wider">
                        <Clock size={14} />
                        <span>Menuju Kegiatan Berikutnya</span>
                    </div>
                    <div className="font-bold text-lg leading-tight mb-3 text-center">
                        "{nextEvent.event}"
                    </div>
                    <div className="flex justify-center gap-4 text-center">
                        <div>
                            <span className="block text-2xl font-bold font-mono">{timeLeft.days}</span>
                            <span className="text-[10px] uppercase opacity-70">Hari</span>
                        </div>
                        <div className="text-2xl font-bold">:</div>
                        <div>
                            <span className="block text-2xl font-bold font-mono">{timeLeft.hours}</span>
                            <span className="text-[10px] uppercase opacity-70">Jam</span>
                        </div>
                        <div className="text-2xl font-bold">:</div>
                        <div>
                            <span className="block text-2xl font-bold font-mono">{timeLeft.minutes}</span>
                            <span className="text-[10px] uppercase opacity-70">Menit</span>
                        </div>
                    </div>
                </div>
            );
        };

        // --- MAIN APP COMPONENT ---
        function App() {
            const [activeCategory, setActiveCategory] = useState('Semua');
            const [searchTerm, setSearchTerm] = useState('');
            const [todayDate, setTodayDate] = useState(null);
            const [todayMonth, setTodayMonth] = useState(null);
            const [selectionMode, setSelectionMode] = useState(false);
            const [selectedIds, setSelectedIds] = useState(new Set());
            
            const todayRef = useRef(null);

            useEffect(() => {
                const loadParticles = async () => {
                    await window.tsParticles.load("tsparticles", {
                        fullScreen: { enable: false },
                        fpsLimit: 60,
                        particles: {
                            number: { value: 60, density: { enable: true, area: 800 } },
                            color: { value: ["#fbbf24", "#ffffff", "#fcd34d"] },
                            shape: { type: ["circle", "star"], options: { star: { sides: 5 } } },
                            opacity: { value: 0.6, random: true, anim: { enable: true, speed: 1, opacity_min: 0.1 } },
                            size: { value: { min: 1, max: 3 }, random: true, anim: { enable: true, speed: 2, size_min: 0.1 } },
                            move: { enable: true, speed: 0.5, direction: "none", random: true, outModes: { default: "out" } }
                        },
                        interactivity: {
                            events: { onHover: { enable: true, mode: "bubble" }, onClick: { enable: true, mode: "push" }, resize: true },
                            modes: { bubble: { distance: 100, size: 5, duration: 2, opacity: 0.8 }, push: { quantity: 4 } }
                        },
                        detectRetina: true,
                        background: { color: "transparent" }
                    });
                };
                loadParticles();

                const date = new Date();
                setTodayDate(date.getDate()); 
                setTodayMonth(date.getMonth()); 
            }, []);

            useEffect(() => {
                if (todayRef.current && activeCategory === 'Semua' && !searchTerm) {
                    const timer = setTimeout(() => {
                        todayRef.current.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'center' });
                    }, 1000); 
                    return () => clearTimeout(timer);
                }
            }, [activeCategory, searchTerm]);

            // Handlers
            const toggleSelection = (id) => {
                const newSelection = new Set(selectedIds);
                newSelection.has(id) ? newSelection.delete(id) : newSelection.add(id);
                setSelectedIds(newSelection);
            };

            const toggleSelectionMode = () => {
                if (selectionMode) setSelectedIds(new Set());
                setSelectionMode(!selectionMode);
            };

            const generateICS = (item) => {
                const startDate = new Date(YEAR, item.month, item.day, 16, 0, 0); // 4 PM start default
                const endDate = new Date(YEAR, item.month, item.day, 19, 0, 0);   // 7 PM end default
                
                const formatDate = (date) => date.toISOString().replace(/-|:|\.\d\d\d/g, "");

                const icsContent = `BEGIN:VCALENDAR
VERSION:2.0
BEGIN:VEVENT
SUMMARY:${item.event}
DTSTART:${formatDate(startDate)}
DTEND:${formatDate(endDate)}
LOCATION:${item.loc || 'Di Tempat'}
DESCRIPTION:Kegiatan CSR Ramadhan ${item.event}.
END:VEVENT
END:VCALENDAR`;

                const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
                const link = document.createElement('a');
                link.href = window.URL.createObjectURL(blob);
                link.setAttribute('download', `${item.event}.ics`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            };

            const handleMultiShare = () => {
                const selectedItems = scheduleData.filter(item => selectedIds.has(item.id)).sort((a, b) => a.id - b.id);
                if (selectedItems.length === 0) return;

                let message = "‚ú® *Jadwal Pilihan CSR Ramadhan 1447 H* ‚ú®\n\n";
                selectedItems.forEach((item, index) => {
                    message += `${index + 1}. *${item.event || 'Agenda Rutin'}*\n`;
                    message += `   üóìÔ∏è ${item.date} (Ramadhan ke-${item.ramadhan})\n`;
                    if (item.loc) message += `   üìç ${item.loc}\n`;
                    message += "\n";
                });
                message += "Sumber: Program CSR & Kegiatan Sosial PT SBI";
                window.open(`https://wa.me/?text=${encodeURIComponent(message)}`, '_blank');
            };

            // Filtering
            const filteredData = scheduleData.filter(item => {
                const matchesCategory = activeCategory === 'Semua' || item.category === activeCategory || (activeCategory === 'Sosial' && item.event.includes('Bazar') && item.event.includes('Sembako'));
                const matchesSearch = item.event.toLowerCase().includes(searchTerm.toLowerCase()) || item.loc.toLowerCase().includes(searchTerm.toLowerCase());
                return matchesCategory && matchesSearch;
            });

            const getCategoryTheme = (cat) => {
                switch(cat) {
                    case 'Bazar': return { badge: 'text-rose-700 bg-rose-50 border-rose-200', border: 'border-rose-200 hover:border-rose-400', dayBg: 'bg-rose-500', iconColor: 'text-rose-500', mapBg: 'bg-rose-50' };
                    case 'Bukber': return { badge: 'text-amber-700 bg-amber-50 border-amber-200', border: 'border-amber-200 hover:border-amber-400', dayBg: 'bg-amber-500', iconColor: 'text-amber-500', mapBg: 'bg-amber-50' };
                    case 'Sosial': return { badge: 'text-cyan-700 bg-cyan-50 border-cyan-200', border: 'border-cyan-200 hover:border-cyan-400', dayBg: 'bg-cyan-500', iconColor: 'text-cyan-500', mapBg: 'bg-cyan-50' };
                    case 'Edukasi': return { badge: 'text-indigo-700 bg-indigo-50 border-indigo-200', border: 'border-indigo-200 hover:border-indigo-400', dayBg: 'bg-indigo-500', iconColor: 'text-indigo-500', mapBg: 'bg-indigo-50' };
                    default: return { badge: 'text-slate-600 bg-slate-100 border-slate-200', border: 'border-slate-100 hover:border-slate-300', dayBg: 'bg-slate-400', iconColor: 'text-slate-400', mapBg: 'bg-slate-50' };
                }
            };

            const getIcon = (cat) => {
                switch(cat) {
                    case 'Bazar': return <ShoppingBag className="w-4 h-4" />;
                    case 'Bukber': return <Utensils className="w-4 h-4" />;
                    case 'Sosial': return <Gift className="w-4 h-4" />;
                    case 'Edukasi': return <BookOpen className="w-4 h-4" />;
                    default: return <Moon className="w-4 h-4" />;
                }
            };

            return (
                <div className="min-h-screen font-sans text-slate-800 pb-24">
                    {/* Header */}
                    <div className="bg-emerald-900 pb-16 pt-10 relative overflow-hidden rounded-b-[2.5rem] shadow-2xl">
                        <div id="tsparticles" className="absolute top-0 left-0 w-full h-full z-0"></div>
                        <div className="absolute top-0 left-0 w-full h-full bg-gradient-to-b from-transparent to-emerald-950/80 z-0 pointer-events-none"></div>
                        
                        <div className="container mx-auto px-4 relative z-10">
                            <div className="text-center">
                                <h1 className="text-3xl md:text-5xl font-bold text-white mb-2 tracking-wide font-serif drop-shadow-md">
                                    Ramadhan 1447 H
                                </h1>
                                <p className="text-emerald-100 text-lg font-light tracking-widest uppercase drop-shadow-sm opacity-90">Jadwal CSR & Sosial PT SBI</p>
                            </div>
                            
                            <Countdown events={scheduleData} />
                        </div>
                    </div>

                    {/* Controls Section */}
                    <div className="container mx-auto px-4 -mt-8 relative z-20">
                        <div className="bg-white/90 backdrop-blur-md rounded-2xl shadow-xl border border-white/50 p-4 space-y-4">
                            
                            {/* Top Row: Search & Selection Toggle */}
                            <div className="flex flex-col md:flex-row justify-between gap-3">
                                <div className="relative flex-1">
                                    <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" />
                                    <input 
                                        type="text" 
                                        placeholder="Cari kegiatan, lokasi (misal: Sembako)..." 
                                        className="w-full pl-10 pr-4 py-2.5 rounded-xl border border-gray-200 bg-gray-50 focus:bg-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all outline-none text-sm"
                                        value={searchTerm}
                                        onChange={(e) => setSearchTerm(e.target.value)}
                                    />
                                </div>
                                <button
                                    onClick={toggleSelectionMode}
                                    className={`flex items-center justify-center gap-2 px-5 py-2.5 rounded-xl text-sm font-bold transition-all duration-300 border
                                        ${selectionMode 
                                            ? 'bg-slate-800 text-white border-slate-800 shadow-lg' 
                                            : 'bg-white text-slate-600 border-gray-200 hover:bg-gray-50'}`}
                                >
                                    <CheckSquare size={18} />
                                    {selectionMode ? 'Batal' : 'Pilih Banyak'}
                                </button>
                            </div>

                            {/* Bottom Row: Categories */}
                            <div className="flex flex-wrap justify-center md:justify-start gap-2">
                                {categories.map((cat) => (
                                    <button
                                        key={cat.id}
                                        onClick={() => setActiveCategory(cat.id)}
                                        className={`flex items-center gap-2 px-4 py-2 rounded-lg text-xs md:text-sm font-medium transition-all duration-300 whitespace-nowrap border
                                            ${activeCategory === cat.id 
                                                ? `${cat.color} border-transparent text-white shadow-md scale-105` 
                                                : 'bg-white border-gray-100 text-gray-600 hover:bg-gray-50'}`}
                                    >
                                        <cat.icon className="w-4 h-4" />
                                        {cat.label}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>

                    {/* Content Grid */}
                    <div className="container mx-auto px-4 mt-8">
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                            {filteredData.map((item, index) => {
                                if (activeCategory !== 'Semua' && !item.event) return null;
                                
                                const theme = getCategoryTheme(item.category);
                                const isToday = item.day === todayDate && item.month === todayMonth;
                                const isSelected = selectedIds.has(item.id);

                                return (
                                    <div 
                                        key={index}
                                        ref={isToday ? todayRef : null}
                                        onClick={() => selectionMode && item.event && toggleSelection(item.id)}
                                        className={`group relative glass-card rounded-2xl p-6 pb-12 border transition-all duration-300
                                            ${selectionMode && item.event ? 'cursor-pointer' : ''}
                                            ${item.event ? `${theme.border} hover:shadow-xl hover:-translate-y-1` : 'border-gray-100 opacity-60 hover:opacity-100'}
                                            ${isToday ? 'card-today ring-4 ring-emerald-100' : ''}
                                            ${isSelected ? 'ring-2 ring-emerald-500 bg-emerald-50/90' : ''}
                                        `}
                                    >
                                        {selectionMode && item.event && (
                                            <div className="absolute top-4 left-4 z-20">
                                                <div className={`w-6 h-6 rounded-md border-2 flex items-center justify-center transition-all duration-200
                                                    ${isSelected ? 'bg-emerald-500 border-emerald-500 text-white scale-110' : 'bg-white border-gray-300 text-transparent'}
                                                `}>
                                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="4" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>
                                                </div>
                                            </div>
                                        )}

                                        {isToday && (
                                            <div className="absolute -top-3 left-1/2 transform -translate-x-1/2 z-20 badge-today w-full text-center">
                                                <div className="inline-flex bg-emerald-600 text-white text-[10px] font-bold px-3 py-1 rounded-full shadow-lg border-2 border-white items-center gap-1">
                                                    <span>üìç</span> HARI INI
                                                </div>
                                            </div>
                                        )}

                                        <div className="absolute -top-3 -right-3">
                                            <div className={`w-12 h-12 rounded-full flex flex-col items-center justify-center text-xs font-bold text-white shadow-md ${theme.dayBg}`}>
                                                <span className="text-[10px] font-normal opacity-90">Ke</span>
                                                <span className="text-lg leading-none">{item.ramadhan}</span>
                                            </div>
                                        </div>

                                        <div className={`flex items-center gap-3 mb-4 ${selectionMode ? 'pl-8' : ''} transition-all`}> 
                                            <div className={`p-2 rounded-xl font-bold text-xl min-w-[3.5rem] text-center border backdrop-blur-sm
                                                bg-white/50 ${theme.iconColor || 'text-slate-500'} ${theme.border}
                                            `}>
                                                {item.day}
                                            </div>
                                            <div className="flex flex-col">
                                                <span className="text-[10px] text-slate-500 uppercase tracking-wider font-bold">Tanggal</span>
                                                <span className={`font-medium ${isToday ? 'text-emerald-700 font-bold' : 'text-slate-700'}`}>
                                                    {item.date.split(',')[0]}
                                                </span>
                                            </div>
                                        </div>

                                        {item.event ? (
                                            <div className="space-y-3">
                                                <div className={`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-[10px] uppercase font-bold border tracking-wide ${theme.badge}`}>
                                                    {getIcon(item.category)}
                                                    {item.category}
                                                </div>
                                                
                                                <h3 className="text-lg font-bold text-slate-800 leading-snug group-hover:text-emerald-800 transition-colors">
                                                    {item.event}
                                                </h3>
                                                
                                                {item.loc && (
                                                    <div className={`flex items-start gap-2 text-xs font-medium text-slate-600 mt-2 p-2 rounded-lg bg-white/60 border border-white/50`}>
                                                        <MapPin size={14} className={`mt-0.5 flex-shrink-0 ${theme.iconColor}`} />
                                                        <span>{item.loc}</span>
                                                    </div>
                                                )}

                                                {!selectionMode && (
                                                    <div className="absolute bottom-4 right-4 flex gap-2">
                                                        <button
                                                            onClick={(e) => { e.stopPropagation(); generateICS(item); }}
                                                            className="p-2 rounded-full bg-white text-slate-400 hover:text-blue-600 border border-slate-200 hover:border-blue-500 shadow-sm hover:shadow-md transition-all hover:scale-105"
                                                            title="Simpan ke Kalender"
                                                        >
                                                            <CalendarPlus size={18} />
                                                        </button>
                                                        <button
                                                            onClick={(e) => {
                                                                e.stopPropagation();
                                                                const text = `‚ú® *Jadwal CSR Ramadhan 1447 H* ‚ú®\n\nüóìÔ∏è ${item.date} (Ramadhan ke-${item.ramadhan})\nüéâ *${item.event}*\nüìç Lokasi: ${item.loc || 'Di Tempat'}\n\nSumber: Program CSR & Kegiatan Sosial PT SBI`;
                                                                window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
                                                            }}
                                                            className="p-2 rounded-full bg-white text-slate-400 hover:text-green-600 border border-slate-200 hover:border-green-500 shadow-sm hover:shadow-md transition-all hover:scale-105"
                                                            title="Bagikan ke WhatsApp"
                                                        >
                                                            <ShareIcon size={18} />
                                                        </button>
                                                    </div>
                                                )}
                                            </div>
                                        ) : (
                                            <div className="h-20 flex items-center justify-center text-slate-400 italic text-xs border-2 border-dashed border-slate-200 rounded-xl bg-slate-50/50">
                                                Tidak ada agenda
                                            </div>
                                        )}
                                    </div>
                                );
                            })}
                        </div>

                        {filteredData.length === 0 && (
                            <div className="text-center py-20">
                                <div className="inline-flex items-center justify-center w-16 h-16 bg-white border border-gray-100 shadow-sm rounded-full mb-4">
                                    <Search className="text-gray-300" size={32} />
                                </div>
                                <h3 className="text-lg font-bold text-gray-600">Tidak ada agenda ditemukan</h3>
                                <p className="text-gray-400 text-sm">Coba kata kunci atau kategori lain.</p>
                            </div>
                        )}
                    </div>
                    
                    {selectionMode && selectedIds.size > 0 && (
                        <div className="fixed bottom-6 left-1/2 transform -translate-x-1/2 z-50 fab-slide-up w-full max-w-md px-4">
                            <button
                                onClick={handleMultiShare}
                                className="w-full bg-[#25D366] hover:bg-[#20bd5a] text-white font-bold py-4 px-6 rounded-2xl shadow-2xl flex items-center justify-center gap-3 transition-transform hover:scale-105 active:scale-95 border-2 border-white/20"
                            >
                                <ShareIcon size={24} />
                                <span>Bagikan ({selectedIds.size}) Agenda via WA</span>
                            </button>
                        </div>
                    )}
                    
                    <footer className="mt-20 text-center text-slate-400 text-xs pb-10">
                        <p>¬© 1447 H Program CSR Ramadhan</p>
                        <p className="mt-1 font-serif italic text-slate-300">Indahnya Berbagi, Eratkan Silaturahmi</p>
                    </footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
